#include "stdio.h"
#include "stdint.h"
#include "general.c"

#define CHECK(__NUM__)                                                                              \
    if (mem[addr] != hex2int(#__NUM__)) {                                                           \
        error++;                                                                                    \
        printf("ADDR:0x%08x EXP:0x%08x GOT:0x%08x\n", addr, hex2int(#__NUM__), mem[addr]);          \
    }                                                                                               \
    addr++;                                                                                         \

uint8_t mem [] = {};

int main() {

    for (int i = 0; i < 1000; i++) mem[i] = 0;
    read_intel_hex("build/risc_v_tests/addi.s/addi.s.hex", mem);

    int error = 0;
    int addr = 0;

    CHECK(13) CHECK(00) CHECK(10) CHECK(00) CHECK(93) CHECK(00) CHECK(10) CHECK(00) CHECK(13) CHECK(81) CHECK(10) CHECK(00) CHECK(93) CHECK(01) CHECK(11) CHECK(00)
    CHECK(13) CHECK(82) CHECK(11) CHECK(00) CHECK(93) CHECK(02) CHECK(12) CHECK(00) CHECK(13) CHECK(83) CHECK(12) CHECK(00) CHECK(93) CHECK(03) CHECK(13) CHECK(00)
    CHECK(13) CHECK(84) CHECK(13) CHECK(00) CHECK(93) CHECK(04) CHECK(14) CHECK(00) CHECK(13) CHECK(85) CHECK(14) CHECK(00) CHECK(93) CHECK(05) CHECK(15) CHECK(00)
    CHECK(13) CHECK(86) CHECK(15) CHECK(00) CHECK(93) CHECK(06) CHECK(16) CHECK(00) CHECK(13) CHECK(87) CHECK(16) CHECK(00) CHECK(93) CHECK(07) CHECK(17) CHECK(00)
    CHECK(13) CHECK(88) CHECK(17) CHECK(00) CHECK(93) CHECK(08) CHECK(18) CHECK(00) CHECK(13) CHECK(89) CHECK(18) CHECK(00) CHECK(93) CHECK(09) CHECK(19) CHECK(00)
    CHECK(13) CHECK(8A) CHECK(19) CHECK(00) CHECK(93) CHECK(0A) CHECK(1A) CHECK(00) CHECK(13) CHECK(8B) CHECK(1A) CHECK(00) CHECK(93) CHECK(0B) CHECK(1B) CHECK(00)
    CHECK(13) CHECK(8C) CHECK(1B) CHECK(00) CHECK(93) CHECK(0C) CHECK(1C) CHECK(00) CHECK(13) CHECK(8D) CHECK(1C) CHECK(00) CHECK(93) CHECK(0D) CHECK(1D) CHECK(00)
    CHECK(13) CHECK(8E) CHECK(1D) CHECK(00) CHECK(93) CHECK(0E) CHECK(1E) CHECK(00) CHECK(13) CHECK(8F) CHECK(1E) CHECK(00) CHECK(93) CHECK(0F) CHECK(1F) CHECK(00)
    CHECK(13) CHECK(8F) CHECK(0F) CHECK(00) CHECK(93) CHECK(0E) CHECK(0F) CHECK(00) CHECK(13) CHECK(8E) CHECK(0E) CHECK(00) CHECK(93) CHECK(0D) CHECK(0E) CHECK(00)
    CHECK(13) CHECK(8D) CHECK(0D) CHECK(00) CHECK(93) CHECK(0C) CHECK(0D) CHECK(00) CHECK(13) CHECK(8C) CHECK(0C) CHECK(00) CHECK(93) CHECK(0B) CHECK(0C) CHECK(00)
    CHECK(13) CHECK(8B) CHECK(0B) CHECK(00) CHECK(93) CHECK(0A) CHECK(0B) CHECK(00) CHECK(13) CHECK(8A) CHECK(0A) CHECK(00) CHECK(93) CHECK(09) CHECK(0A) CHECK(00)
    CHECK(13) CHECK(89) CHECK(09) CHECK(00) CHECK(93) CHECK(08) CHECK(09) CHECK(00) CHECK(13) CHECK(88) CHECK(08) CHECK(00) CHECK(93) CHECK(07) CHECK(08) CHECK(00)
    CHECK(13) CHECK(87) CHECK(07) CHECK(00) CHECK(93) CHECK(06) CHECK(07) CHECK(00) CHECK(13) CHECK(86) CHECK(06) CHECK(00) CHECK(93) CHECK(05) CHECK(06) CHECK(00)
    CHECK(13) CHECK(85) CHECK(05) CHECK(00) CHECK(93) CHECK(04) CHECK(05) CHECK(00) CHECK(13) CHECK(84) CHECK(04) CHECK(00) CHECK(93) CHECK(03) CHECK(04) CHECK(00)
    CHECK(13) CHECK(83) CHECK(03) CHECK(00) CHECK(93) CHECK(02) CHECK(03) CHECK(00) CHECK(13) CHECK(82) CHECK(02) CHECK(00) CHECK(93) CHECK(01) CHECK(02) CHECK(00)
    CHECK(13) CHECK(81) CHECK(01) CHECK(00) CHECK(93) CHECK(00) CHECK(01) CHECK(00) CHECK(13) CHECK(80) CHECK(00) CHECK(00)

    if (error) printf("FAILED..!\n");
    else printf("PASSED..!\n");

    return error;

}
